@page "/Employee"
@inherits RazorPageBases.EmployeePageBase;
@attribute [Authorize(Roles = "Employee")]


@if (currentEmployee == null)
{
	<p>Loading...</p>
}
else
{
<MudGrid Justify="Justify.FlexStart" Style="margin-bottom:30px;">
	<MudItem xs=9>
		<MudAvatar Size="Size.Large" Style="width:150px;height:150px; margin-bottom:30px;" Color="Color.Primary">@currentEmployee.LastName.Substring(0, 1)@currentEmployee.FirstName.Substring(0, 1)</MudAvatar>
		<h3>@currentEmployee.LastName @currentEmployee.FirstName</h3>
	</MudItem>
	<MudItem xs=3>
		<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OpenAddVacationDialog" Style="margin-right:3%" StartIcon="@Icons.Material.Filled.Add">Add Vacation</MudButton>
		<MudButton Variant="Variant.Filled" Color="Color.Dark" OnClick="OpenEmployeeHistoryPage" Style="position:absolute;margin-right:5%">History</MudButton>
	</MudItem>
</MudGrid>
<MudGrid Justify="Justify.FlexStart" Style="margin-bottom:30px;">
	<MudItem>
		<MudText>Remaining vacation for last year: @currentEmployee.RemainingDaysOffLastYear</MudText>
		<MudText>Remaining vacation for current year: @currentEmployee.RemainingDaysOffCurrentYear</MudText>
	</MudItem>
</MudGrid>
<MudTable Items="@currentEmployee.VacationDays" Hover=true SortLabel="Sort By" Filter="new Func<Vacation,bool>(FilterFunction)" @bind-SelectedItem="selectedVacation">
	<ToolBarContent>
		<MudText Typo="Typo.h6">Approved Vacations</MudText>
		<MudSpacer />
		<MudTextField @bind-Value="searchString1" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
	</ToolBarContent>
	<HeaderContent>
		<MudTh>Last Name</MudTh>
		<MudTh>First Name</MudTh>
		<MudTh><MudTableSortLabel SortBy="new Func<Vacation, object>(x=>x.VacationRequestDate)">Vacation Request Date</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<Vacation, object>(x=>x.VacationFrom)">Vacation From</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<Vacation, object>(x=>x.VacationTo)">Vacation To</MudTableSortLabel></MudTh>
		<MudTh><MudTableSortLabel SortBy="new Func<Vacation, object>(x=>x.VacationSpent)">Vacation Spent</MudTableSortLabel></MudTh>
		<MudTh>Vacation Status</MudTh>
		<MudTh></MudTh>
	</HeaderContent>
	<RowTemplate>
		<MudTd DataLabel="Last Name">@context.User.LastName</MudTd>
		<MudTd DataLabel="First Name">@context.User.FirstName</MudTd>
		<MudTd DataLabel="Vacation Request Date">@context.VacationRequestDate</MudTd>
		<MudTd DataLabel="Vacation From">@context.VacationFrom.ToString("dd.MM.yyyy")</MudTd>
		<MudTd DataLabel="Vacation To">@context.VacationTo.ToString("dd.MM.yyyy")</MudTd>
		<MudTd DataLabel="Total Vacation Spent">@context.VacationSpent</MudTd>
		<MudTd DataLabel="Vacation Status">@context.Status</MudTd>
		<MudTd>
			<MudButton ButtonType="ButtonType.Button" OnClick="() => DeleteVacationRequest(context.Id)" StartIcon="@Icons.Material.Filled.Delete" Style="color:red;"></MudButton>
		</MudTd>
	</RowTemplate>
	<PagerContent>
		<MudTablePager />
	</PagerContent>
</MudTable>
}